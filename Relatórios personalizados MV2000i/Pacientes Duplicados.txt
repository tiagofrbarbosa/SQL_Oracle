SELECT CD_PACIENTE Codigo 
       , DS_CHECAPAC 
       , NM_PACIENTE 
       , DT_NASCIMENTO 
       , NM_MAE 
       , NM_USUARIO 
       , cd_multi_empresa FROM ( SELECT PACIENTE . CD_PACIENTE CD_PACIENTE 
                                        , PACIENTE . DS_CHECAPAC DS_CHECAPAC 
                                        , PACIENTE . NM_PACIENTE NM_PACIENTE 
                                        , PACIENTE . DT_NASCIMENTO DT_NASCIMENTO 
                                        , PACIENTE . NM_MAE NM_MAE 
                                        , PACIENTE . NM_USUARIO NM_USUARIO 
                                        , paciente . cd_multi_empresa
                                   FROM DBAMV . PACIENTE PACIENTE WHERE EXISTS ( SELECT 'X' FROM dbamv . paciente paci 
                                                                                    WHERE PACIENTE . CD_PACIENTE <> PACI . CD_PACIENTE
                                                                                     and paci.cd_multi_empresa = 1 
                                                                                      AND Paciente . Nm_Paciente = Paci . Nm_Paciente 
                                                                                      AND ( paciente . ds_checaPac = paci . ds_checaPac OR paciente . ds_checaPac is null OR paci . ds_checaPac IS null ) 
                                                                                      AND ( TRUNC ( Paciente . Dt_Nascimento ) = Trunc ( Paci . Dt_Nascimento ) OR Paciente . Dt_Nascimento IS NULL OR Paci . Dt_Nascimento IS null ) 
                                                                                      AND ( Paciente . NM_MAE = Paci . NM_MAE OR Paci . NM_MAE IS NULL OR Paciente . NM_MAE IS null )    )    
                                                                                      and paciente.cd_multi_empresa = 1 
             ORDER BY nm_paciente , DS_CHECAPAC )
