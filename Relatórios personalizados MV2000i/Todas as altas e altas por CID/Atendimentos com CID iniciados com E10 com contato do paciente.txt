SELECT A.CD_ATENDIMENTO "ATENDIMENTO",
       P.NM_PACIENTE "NOME",
       TO_CHAR(P.DT_NASCIMENTO,'DD/MM/YYYY') "NASCIMENTO",
       trunc((months_between(sysdate, P.DT_NASCIMENTO))/12) "IDADE",
       P.TP_SEXO "SEXO",
       TO_CHAR(A.DT_ATENDIMENTO,'DD/MM/YYYY') "DATA ATENDIMENTO",
       E.DS_ESPECIALID "ESPECIALIDADE",
       A.CD_CID,
       C.DS_CID "DESCRIÇÃO CID",
       TIP.DS_TIP_RES "MOTIVO ALTA",
       P.DS_ENDERECO "RUA",
       P.NR_ENDERECO "NUMERO",
       P.NR_CEP "CEP",
       P.NM_BAIRRO "BAIRRO",
       CD.NM_CIDADE "CIDADE",
       CD.CD_UF "ESTADO",
       (SELECT CON.NR_DDD || '-' || CON.NR_TELEFONE FROM CONTATO_PACIENTE CON WHERE CON.CD_PACIENTE = P.CD_PACIENTE AND CON.TP_CONTATO = 'R' AND CON.SN_PADRAO = 'S') TEL_RESIDENCIAL,
       (SELECT CON.NR_DDD || '-' || CON.NR_TELEFONE FROM CONTATO_PACIENTE CON WHERE CON.CD_PACIENTE = P.CD_PACIENTE AND CON.TP_CONTATO = 'C' AND CON.SN_PADRAO = 'S') TEL_CELULAR,
       (SELECT CON.NR_DDD || '-' || CON.NR_TELEFONE FROM CONTATO_PACIENTE CON WHERE CON.CD_PACIENTE = P.CD_PACIENTE AND CON.TP_CONTATO = 'O' AND CON.SN_PADRAO = 'S') TEL_COMERCIAL
FROM ATENDIME A,
     PACIENTE P,
     ESPECIALID E,
     CID C,
     TIP_RES TIP,
     CIDADE CD
WHERE A.DT_ATENDIMENTO BETWEEN '01-07-2015' AND '28-10-2015'
AND P.CD_PACIENTE = A.CD_PACIENTE
AND A.CD_ESPECIALID = E.CD_ESPECIALID
AND A.CD_CID LIKE 'E10%'
AND A.CD_CID = C.CD_CID
AND A.CD_MULTI_EMPRESA = 1
AND A.CD_TIP_RES = TIP.CD_TIP_RES(+)
AND CD.CD_CIDADE = P.CD_CIDADE(+)
ORDER BY 1