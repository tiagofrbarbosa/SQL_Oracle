SELECT DT_VENC, DT_PAG, NF, DT_EMISSAO, FORNECEDOR, SAIDAS VL_BRUTO, VL_DUPLICATA VL_LIQUIDO, SUM(SAIDAS) OVER(ORDER BY rownum ROWS UNBOUNDED PRECEDING) VL_GASTO FROM(SELECT rownum, DT_VENCIMENTO DT_VENC, DT_PAGAMENTO DT_PAG, NR_DOCUMENTO NF, DT_EMISSAO, NM_FORNECEDOR FORNECEDOR, VL_BRUTO_CONTA SAIDAS, VL_DUPLICATA FROM(SELECT CON_PAG.CD_MULTI_EMPRESA CD_MULTI_EMPRESA, CON_PAG.CD_FORNECEDOR CD_FORNECEDOR, DECODE(CON_PAG.CD_FORNECEDOR, NULL, CON_PAG.DS_FORNECEDOR, FORNECEDOR.NM_FANTASIA)  NM_FORNECEDOR,CON_PAG.CD_CON_PAG, CON_PAG.NR_DOCUMENTO NR_DOCUMENTO, ITCON_PAG.NR_PARCELA NR_PARCELA,CON_PAG.DT_EMISSAO DT_EMISSAO,ITCON_PAG.DT_VENCIMENTO DT_VENCIMENTO,DECODE(ITCON_PAG.TP_QUITACAO, 'V', 'Prev', 'Q', 'Quit', 'P', 'Parc', 'C', 'Comp','T','DevT', 'L', 'DevP' ) TP_QUITACAO,CON_PAG.VL_BRUTO_CONTA,ITCON_PAG.VL_DUPLICATA,PAGCON_PAG.DT_PAGAMENTO DT_PAGAMENTO FROM DBAMV.PAGCON_PAG,DBAMV.ITCON_PAG,DBAMV.CON_PAG,DBAMV.FORNECEDOR,DBAMV.TIP_DOC WHERE PAGCON_PAG.CD_ITCON_PAG(+)  =    ITCON_PAG.CD_ITCON_PAG and ITCON_PAG.TP_QUITACAO NOT IN ( 'T' , 'L', 'V') AND        ITCON_PAG.CD_CON_PAG     =    CON_PAG.CD_CON_PAG AND CON_PAG.CD_FORNECEDOR    =    FORNECEDOR.CD_FORNECEDOR (+) AND        CON_PAG.CD_TIP_DOC       =    TIP_DOC.CD_TIP_DOC AND CON_PAG.CD_PREVISAO IS NULL AND nvl(PAGCON_PAG.TP_PAGAMENTO, '0') <> '6' AND TO_CHAR(ITCON_PAG.DT_VENCIMENTO,'MM/YYYY') BETWEEN TO_CHAR(sysdate,'MM/YYYY') AND TO_CHAR(sysdate,'MM/YYYY') AND CON_PAG.CD_MULTI_EMPRESA = 1 ORDER BY ITCON_PAG.DT_VENCIMENTO)ORDER BY DT_VENCIMENTO)