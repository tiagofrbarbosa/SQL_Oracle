---------------POR ESPECIALIDADE

SELECT cd_loc_proced "Código",
       ds_loc_proced "Unidade",
       ds_especialid "Especialidade",
       sum(SOMA)"1º Consulta"
FROM(
SELECT l.cd_loc_proced,
       l.ds_loc_proced,
       e.ds_especialid,COUNT(*)SOMA
FROM ATENDIME A,loc_proced L,ESPECIALID E
WHERE A.CD_LOC_PROCED = L.CD_LOC_PROCED
AND A.CD_ESPECIALID = e.cd_especialid
AND a.dt_atendimento BETWEEN '02-09-2013' AND '02-09-2013'
AND A.cd_tip_mar = 1
GROUP BY l.cd_loc_proced, l.ds_loc_proced, e.ds_especialid)
GROUP BY cd_loc_proced,ds_loc_proced,ds_especialid
ORDER BY ds_loc_proced,ds_especialid;

---------------POR SERVIÇO

SELECT cd_loc_proced "Código",
       ds_loc_proced "Unidade",
       DS_SER_DIS "Especialidade",
       sum(SOMA)"1º Consulta"
FROM(
SELECT l.cd_loc_proced,
       l.ds_loc_proced,
       SD.DS_SER_DIS,COUNT(*)SOMA
FROM ATENDIME A,loc_proced L,SER_DIS SD, IT_AGENDA_CENTRAL IT
WHERE A.CD_LOC_PROCED = L.CD_LOC_PROCED
AND a.cd_atendimento = it.cd_atendimento
AND IT.CD_SER_DIS = SD.CD_SER_DIS
AND a.dt_atendimento BETWEEN '02-09-2013' AND '02-09-2013'
AND A.cd_tip_mar = 1
GROUP BY l.cd_loc_proced, l.ds_loc_proced, SD.DS_SER_DIS)
GROUP BY cd_loc_proced,ds_loc_proced,ds_ser_dis
ORDER BY ds_loc_proced,ds_ser_dis;

---------------EM ANDAMENTO


SELECT l.cd_loc_proced,
       l.ds_loc_proced,
       SD.DS_SER_DIS,COUNT(*)SOMA
FROM ATENDIME A,loc_proced L,SER_DIS SD, IT_AGENDA_CENTRAL IT, AGENDA_CENTRAL AC
WHERE A.CD_LOC_PROCED = L.CD_LOC_PROCED
AND a.cd_atendimento = it.cd_atendimento
AND a.dt_atendimento BETWEEN '02-09-2013' AND '02-09-2013'
AND A.cd_tip_mar = 1
AND A.CD_MULTI_EMPRESA = 1
GROUP BY l.cd_loc_proced, l.ds_loc_proced, SD.DS_SER_DIS)
GROUP BY cd_loc_proced,ds_loc_proced,ds_ser_dis
ORDER BY ds_loc_proced,ds_ser_dis;

SELECT CD_LOC_PROCED,
       DS_LOC_PROCED,
       DS_SER_DIS,
       SUM(AGENDADOS)AGE,
       SUM(ATENDIDOS)ATEN,
       SUM(PRIMEIRA) PRI,
       SUM(RETORNO) RET,
       SUM(ENCAIXE) ENC
       FROM(
             SELECT L.CD_LOC_PROCED,
                    L.DS_LOC_PROCED,
                    SD.DS_SER_DIS,
                    COUNT(A.CD_ATENDIMENTO) AGENDADOS,
                    0 ATENDIDOS,
                    0 PRIMEIRA,
                    0 RETORNO,
                    0 ENCAIXE
                    FROM ATENDIME A,LOC_PROCED L,SER_DIS SD, IT_AGENDA_CENTRAL IT
                    WHERE A.CD_LOC_PROCED = L.CD_LOC_PROCED
                    AND A.CD_ATENDIMENTO = IT.CD_ATENDIMENTO
                    AND A.DT_ATENDIMENTO BETWEEN '01-01-2013' AND '30-09-2013'
                    AND A.CD_MULTI_EMPRESA = 1
                    GROUP BY L.CD_LOC_PROCED, L.DS_LOC_PROCED,SD.DS_SER_DIS)
                    GROUP BY CD_LOC_PROCED, DS_LOC_PROCED, DS_SER_DIS
                    ORDER BY DS_LOC_PROCED,DS_SER_DIS;

-------------------------

SELECT cd_loc_proced "Código",
       ds_loc_proced "Unidade",
       ds_ser_dis "Especialidade",
       sum(AGE)"Agendado",
       sum(PRICON)"1º Consulta",
       sum(RET)"Retorno"
FROM(
SELECT l.cd_loc_proced,
       l.ds_loc_proced,
       sd.ds_ser_dis,
       COUNT(A.CD_ATENDIMENTO)AGE,
       0 PRICON,
       0 RET
FROM ATENDIME A,loc_proced L,ser_dis sd, it_agenda_central it
WHERE A.CD_LOC_PROCED = L.CD_LOC_PROCED
AND a.cd_atendimento = it.cd_atendimento
AND it.cd_ser_dis = sd.cd_ser_dis
AND a.dt_atendimento BETWEEN '02-09-2013' AND '02-09-2013'
GROUP BY l.cd_loc_proced, l.ds_loc_proced, sd.ds_ser_dis
UNION ALL
SELECT l.cd_loc_proced,
       l.ds_loc_proced,
       sd.ds_ser_dis,
       0 AGE,
       COUNT(A.CD_ATENDIMENTO)PRICON,
       0 RET
FROM ATENDIME A,loc_proced L,ser_dis sd, it_agenda_central it
WHERE A.CD_LOC_PROCED = L.CD_LOC_PROCED
AND a.cd_atendimento = it.cd_atendimento
AND it.cd_ser_dis = sd.cd_ser_dis
AND a.dt_atendimento BETWEEN '02-09-2013' AND '02-09-2013'
AND A.cd_tip_mar = 1
GROUP BY l.cd_loc_proced, l.ds_loc_proced, sd.ds_ser_dis
UNION ALL
SELECT l.cd_loc_proced,
       l.ds_loc_proced,
       sd.ds_ser_dis,
       0 AGE,
       0 PRICON,
       COUNT(A.CD_ATENDIMENTO)RET
FROM ATENDIME A,loc_proced L,ser_dis sd, it_agenda_central it
WHERE A.CD_LOC_PROCED = L.CD_LOC_PROCED
AND a.cd_atendimento = it.cd_atendimento
AND it.cd_ser_dis = sd.cd_ser_dis
AND a.dt_atendimento BETWEEN '02-09-2013' AND '02-09-2013'
AND A.cd_tip_mar = 2
GROUP BY l.cd_loc_proced, l.ds_loc_proced, sd.ds_ser_dis
)
GROUP BY cd_loc_proced,ds_loc_proced,ds_ser_dis
ORDER BY ds_loc_proced,ds_ser_dis;